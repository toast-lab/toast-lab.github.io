<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Lab 7 - Computer Architecture I - ShanghaiTech University</title>
<link rel="shortcut icon" type="image/png" href="../../favicon.ico">

<style type="text/css">
code {background-color: #ddeeff; color: #000000;}
kbd {background-color: #ddeeff; color: #000000;}
.new {background-color: #ffff00; color: #000000;}

div.checkoff {
  background:#eeeee0;
  padding:0.5em 1.5em 0.5em 1.5em;
  border-radius:1em;
  border:1px solid #ddd;
}

pre {
  background:#adc384;
  padding:0.5em 1.5em 0.5em 1.5em;
/*   border-radius:1em; */
  border:1px solid #ddd;
}


</style>
<link rel="stylesheet" type="text/css" href="../style.css">

</head>
<body>
<header>
<h2>Lab 7</h2>
</header>
<a href="../..">Computer Architecture I</a> <a href="http://www.shanghaitech.edu.cn">ShanghaiTech University</a><br>
<a href="../6">Lab 6</a> Lab 7 <a href="../8">Lab 8</a>

<h2 id="setup">Setup</h2>
<p>Please use the Logisim provided in Lab 5.</p>

<h2 id="exercises">Exercises</h2>

<h3 id="exercise-1">Exercise 1: Inefficiencies Everywhere</h3>

<p>For this exercise, we can assume that registers initially carry the value zero. We will be using the lab file <a href="ex1.circ" download>ex1.circ</a>, which should have a subcircuit called <tt>non_pipelined</tt> which looks something like this:</p>

<p><img src="../../../19s/labs/7/exercise2.png" width="500" /></p>

<p>All this circuit does is take in two inputs, multiply them together, and then add the result to the current state value. For this circuit, let the propagation delay of an adder block be 45ns and the propagation delay of a multiplication block be 60ns. The register has a CLK-to-Q delay of 10ns, setup time of 10ns, and hold time of 5ns. <strong>Calculate the maximum clock rate at which this circuit can operate</strong>. Assume that both inputs come from clocked registers that receive their data from an outside source.</p>

<div class='checkoff'>
<h4>Checkoff</h4>
<ul>
	<li>Show your TA the calculations you performed to find the maximum clock rate (non-pipelined).</li>
</ul>
</div>

<h3 id="exercise-2">Exercise 2: Pipe that Line</h3>

<p>We want to improve the performance of this circuit and let it operate at a higher clock rate. In order to accomplish this, we want to have two stages in our pipeline: a multiplication stage and an addition stage, in that order.</p>

<p>In order to check that your pipelining still produces correct outputs, we will consider the outputs from the circuit "correct" if and only if it corresponds to the sequence of outputs the non-pipelined version would emit, bar some leadings zeroes. For example, if for some sequence of inputs, the non-pipelined version emits the sequence [3, 5, 1, 2, 4, …]. Then, the correct pipelined circuit might emit the sequence [0, 3, 5, 1, 2, 4, …] for the same sequence of inputs. You can check this by simulating the circuit (using the "Simulate" menu dropdown) and either ticking the clock manually or enabling continuous ticks.</p>

<p>In your <tt>ex1.circ</tt> file, the <tt>main</tt> circuit is set up to produce the output sequence [3, 5, 1, 2, 4, -1, 0, 0, …] from the non-pipelined version of the circuit. The ROM blocks should be initialized to the proper inputs, but if something goes wrong, select the ROM, click on "Contents", click "Open", then choose <a href="ROMdata" download>ROMdata</a>.</p>

<p>Note that in order to pipeline the circuit, we need a register to hold the intermediate value of the computation between pipeline stages. This is a general theme with pipelines.</p>

<h3 id="tasks">Tasks</h3>
<ul>
  <li>Complete the sub-circuit <tt>pipelined</tt>. You will need to add a register to divide the multiplication and addition stages up.</li>
  <li>Calculate the maximum clock rate for the pipelined version of the circuit that you have created</li>
  <li>We discussed that if a computation depends on the output of a previous computation, it’s difficult to pipeline them and we often need to insert a pipeline "bubble" (or several) to ensure that the output of the first computation is ready to be an input to the second. As a reminder a bubble is the process of purposely delaying an instruction in the pipeline. It is important to understand why such "bubble"s are unnecessary for this particular circuit.</li>
</ul>

<div class='checkoff'>
<h4>Checkoff</h4>
<ul>
	<li>Show your TA the completed, pipelined circuit.</li>
	<li>Show your TA the calculations you performed to find the maximum clock rate (pipelined).</li>
	<li>Explain to your TA why bubbles are unecessary in this circuit.</li>
</ul>
</div>

<footer>
<hr style="clear: both;"/>
<div style="float:left">
<address>
Schwertfeger, S&ouml;ren &lt;<code>soerensch</code> AT <code>shanghaitech.edu.cn</code>&gt;
</address>
<address>
Chundong Wang &lt;<code>wangchd</code> AT <code>shanghaitech.edu.cn</code>&gt;
</address>
Modeled after UC Berkeley's CS61C.<br>
Last modified: <time datetime="2020-04-12">2020-04-12</time>
</div>

</footer>
</body>
</html>
